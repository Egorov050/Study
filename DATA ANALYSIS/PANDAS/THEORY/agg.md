
```python

cohort = df[df['eventName'] == 'register'].groupby('registration_week').agg(
    users=('userId', 'nunique')
).reset_index()

```

здесь , 

`.agg(users=('userId', 'nunique'))` - Агрегация и подсчет уникальных пользователей

- Метод `.agg()` выполняет агрегацию для каждой группы (в данном случае для каждой недели).
- Внутри `agg()` мы передаем `users=('userId', 'nunique')`, что означает, что мы хотим создать новый столбец `users`, где:
    - `'userId'` — это столбец, к которому применяется агрегирующая функция.
    - `'nunique'` — агрегирующая функция, которая подсчитывает количество уникальных значений в этом столбце.
- В итоге `users` будет содержать количество уникальных пользователей (по `userId`), которые зарегистрировались в каждую неделю.
