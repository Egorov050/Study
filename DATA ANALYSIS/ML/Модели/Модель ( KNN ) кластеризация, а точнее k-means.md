Прикол, `knn` может использоваться не только для классификации и  регрессии но и для кластеризации. 

K-means лучше работает с шарообразными структурами данных. 
В отличие от `DBSCAN` , в `k-means` мы должны указать сколько кластеров будем искать. Как выбрать оптимальное количество кластеров мы рассмотрим чуть позже. 

*Как работает алгоритм хорошо описано здесь : https://www.youtube.com/watch?v=EHZJMz6zyFE&t=453s*

Перед тем, как тренировать модель, мы должны провести `некоторые манипуляции` с данными, а именно : 
1)  Удалить выбросы [[Удаление выбросов ( LocalOutlierFactor )]]
2) Подготовить данные [[Подготовка данных]], в том числе и масштабировать их
3) Обработать категориальные данные 
*( База )*

Далее, `инициализируем и тренируем` нашу модель : 

```python 
from sklearn.cluster import KMeans

k = 3
kmeans = KMeans(n_clusters=k, random_state=42)
data_clean['Cluster'] = kmeans.fit_predict(data_clean)
```


Далее, можем визуализировать данные : 

```python

fig = plt.figure(figsize=(8, 6))
ax = fig.add_subplot(111, projection='3d')

ax.scatter(data_clean['Recency'], data_clean['Monetary'], data_clean['Frequency'], c=data_clean['Cluster'], cmap='viridis')
ax.set_xlabel('Feature1')
ax.set_ylabel('Feature2')
ax.set_zlabel('Feature3')
plt.title('K-means Clustering')
plt.show()

```

И получить вот такое : 
<img width="505" alt="Screenshot 2024-07-04 at 18 01 07" src="https://github.com/Egorov050/Study/assets/115251460/47c31a1b-d047-4a9f-b275-e084b842a326">

Теперь самое интересное, как нам выбрать количество кластеров.

Самое простое, это взглянуть на данные и оценочкой глаза самому подобрать количество кластеров. 

*Но очевидно это не лучший способ* Поэтому есть два вспомогательных инструмента, как правильно подобрать оптимальное количество кластеро. Это `Elbow method (метод локтя)` и `silhouette_score`

Рассмотри более подробно. 


<h3>Elbow method (метод локтя)</h3>
Основаная идея метода локтя заключается в следующем. Мы выбираем предположительное `количество кластеров` ( загоняем их в массив ) и для каждого числа кластеров, мы тренируем нашу модель и высчитываем `инерцию ( inertia )`. Это 
- Алгоритм K-Means разделяет данные на k кластеров таким образом, чтобы минимизировать сумму квадратов расстояний между точками и центроидами их кластеров. Эта сумма называется инерцией (inertia).
- Инерция измеряет компактность кластеров: чем меньше инерция, тем плотнее точки внутри кластеров расположены к их центроиду.

