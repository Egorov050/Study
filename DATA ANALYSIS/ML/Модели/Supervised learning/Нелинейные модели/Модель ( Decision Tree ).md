Деревья решений — это популярный метод машинного обучения для классификации и регрессии, который представляет собой модель в виде дерева, где каждая внутренняя вершина (или узел) представляет собой проверку одного из признаков, каждая ветвь — результат этой проверки, а каждое листовое узловое значение — прогнозируемый результат (класс или значение).

<h6>Как работают решающие деревья</h6>
Структура дерева:
- Корневой узел : Начальный узел дерева, содержащий все данные.
- Внутренние узлы : Узлы, в которых происходит проверка одного из признаков.
    - Листовые узлы : Конечные узлы, которые дают окончательный результат (класс или значение).
Построение дерева:
    - Выбор признака и разбиение : На каждом внутреннем узле выбирается признак и порог, по которым данные делятся на подгруппы. Цель — максимизировать различие между подгруппами по какому-либо критерию (например, уменьшение неопределенности).
Прогнозирование:
    - Для нового примера дерево проходит по узлам, проверяя значения признаков и перемещаясь по соответствующим веткам до достижения листового узла, который дает прогноз.


<h2>Регрессия</h2>

```python 
import pandas as pd
import seaborn as sns
import matplotlib as plt
from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeRegressor
```

Для начала испортируем все нужные нам библиотеки включая :

```python 
from sklearn.tree import DecisionTreeRegressor
```

Далее мы подготавливаем наши данные см ( [[Подготовка данных]] )
Как только мы почистили , привели данные в порядок, обработали категориальные данные [[Обработка категориальных данных]],  приступим к сплитованию :
см ( [[Сплит данных перед моделью]] )

Далее, приступаем к машинному обучению.

Сначала инициализируем модель : 

```python 
dt = DecisionTreeRegressor()
```

Затем тренируем нашу модель на `X_train, y_train` : 

```python 
dt.fit(X_train, y_train)
```

Модель натренирована. Теперь мы можем прогнать `X_test` через уже натренированую модель и получить `y_pred`, которую затем мы можем сравнить с `y_test` : 

```python 
y_pred = dt.predict(X_test)
```

<h2>Классификация</h2>
Для начала импортируем библиотеку : 

```python
from sklearn.tree import DecisionTreeClassifier
```

Далее мы подготавливаем наши данные см ( [[Подготовка данных]] )
Как только мы почистили , привели данные в порядок, приступим к сплитованию :
см ( [[Сплит данных перед моделью]] )

Далее, приступаем к машинному обучению.

Сначала инициализируем модель : 

```python 
dt = DecisionTreeClassifier()
```

Затем тренируем нашу модель на `X_train, y_train` : 

```python 
dt.fit(X_train, y_train)
```

Модель натренирована. Теперь мы можем прогнать `X_test` через уже натренированую модель и получить `y_pred`, которую затем мы можем сравнить с `y_test` : 

```python 
y_pred = dt.predict(X_test)
```

<h2>Важные вещи</h2>

Для того, чтобы модель была неперетренирована, нам нужно указать максимально допустимую глубину дерева , делать мы можем это так : 

```python 
DTR = DecisionTreeRegressor(max_depth=5)
```

Это нужно, чтобы не было оверфиттинга

