Алгоритм случайного леса (Random Forest) является видом ансамблевого метода машинного обучения, который используется как для задач классификации, так и для регрессии. Основной принцип работы случайного леса заключается в комбинировании результатов нескольких деревьев решений для получения более точного и стабильного прогноза по сравнению с отдельными деревьями.

Основные шаги работы случайного леса :

<h6>Создание выборок :</h6>
Из обучающего набора данных случайным образом выбираются подмножества данных (с повторениями). Эти подмножества используются для построения каждого дерева решений в лесу. Обычно используется бутстрап 

<h6>Построение деревьев решений</h6>
На каждом подмножестве данных строится отдельное дерево решений. Каждое дерево строится независимо друг от друга.

<h6>Голосование или усреднение : Для задачи классификации результаты всех деревьев комбинируются путем голосования, а для задачи регрессии — путем усреднения предсказаний.

<h2>Регрессия</h2>
Итак, импортируем нужные библиотеки 

```python 
import pandas as pd
import seaborn as sns
import matplotlib as plt
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestRegressor
```

Далее мы подготавливаем наши данные см ( [[Подготовка данных]] )
Как только мы почистили , привели данные в порядок, обработали категориальные данные [[Обработка категориальных данных]],  приступим к сплитованию :
см ( [[Сплит данных перед моделью]] )

Как только наши данные подготовлены, можем приступить к обучению модели : 

```python 
RFR = RandomForestRegressor(min_samples_split=2, max_features=6, max_depth=21)
```

Здесь мы должны указать :

`min_samples_split=2`: Минимальное количество образцов, необходимых для разделения внутреннего узла.

`max_features=6` : Максимальное количество признаков, которые будут рассматриваться при поиске наилучшего разбиения в каждом узле.

`max_depth=21` : Максимальная глубина каждого дерева в лесу

Далее, мы тренируем нашу модель : 

```python 
RFR.fit(X_train, y_train)
y_RFR_train_predict = RFR.predict(X_train)
y_RFR_test_predict = RFR.predict(X_test)
```
