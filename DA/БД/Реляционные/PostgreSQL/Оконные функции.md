
Базовый синтаксис выглядит вот так : 

```SQL
<window_function> OVER (PARTITION BY column1, column2 ORDER BY column3)
```

Cписок основных оконных функций в PostgreSQL, которые можно использовать в запросах с PARTITION BY и ORDER BY для аналитики и агрегации данных:
1. `Агрегационные функции` 
- SUM() — Суммирует значения.
- AVG() — Вычисляет среднее значение.
- MIN() — Находит минимальное значение.
- MAX() — Находит максимальное значение.
- COUNT() — Подсчитывает количество строк.

2. `Функции для рангов`
- ROW_NUMBER() — Присваивает уникальный номер каждой строке в пределах группы, начиная с 1. Ранг зависит от порядка строк.
- RANK() — Присваивает ранг строкам, причем одинаковые строки получают одинаковый ранг, а следующая строка имеет пропущенный ранг.
- DENSE_RANK() — Присваивает ранг строкам, но без пропуска рангов. Если две строки имеют одинаковый ранг, то следующая строка получит следующий ранг, без пропуска.
- NTILE(n) — Делит строки на n равных частей и присваивает каждой строке номер группы (или “ведра”), в которую она попала.

  

**3. Функции для работы с порядком строк**

  

• LEAD() — Возвращает значение из следующей строки относительно текущей строки. Например, можно использовать для получения значения в следующей строке в определенном порядке.

• LAG() — Возвращает значение из предыдущей строки относительно текущей строки.

• FIRST_VALUE() — Возвращает первое значение из окна (первое значение по указанному порядку).

• LAST_VALUE() — Возвращает последнее значение из окна.

• NTH_VALUE() — Возвращает значение строки на заданной позиции в окне.

  

**4. Функции для вычислений на основе окна**

  

• CUME_DIST() — Вычисляет кумулятивное распределение: процент строк, которые меньше или равны текущей строке.

• PERCENT_RANK() — Вычисляет процентный ранг строки среди всех строк в окне. Это мера того, как далеко строка находится от первого значения в окне, выраженная в процентах.

• PERCENTILE_CONT() — Рассчитывает континуальное перцентильное значение для указанного окна. Обычно используется для вычисления медианы или других перцентилей.

• PERCENTILE_DISC() — Рассчитывает дискретное перцентильное значение для окна. Это возвращает конкретное значение, которое соответствует перцентилю в оконных данных.

  

**5. Функции для обработки строк**

  

• STRING_AGG() — Суммирует строки в одну строку, разделяя их заданным разделителем.

  

**6. Функции для статистики**

  

• VAR_POP() — Вычисляет дисперсию для популяции в пределах окна.

• VAR_SAMP() — Вычисляет дисперсию для выборки.

• STDDEV_POP() — Вычисляет стандартное отклонение для популяции.

• STDDEV_SAMP() — Вычисляет стандартное отклонение для выборки.





https://www.youtube.com/watch?v=yQ7qHZBY5xI
