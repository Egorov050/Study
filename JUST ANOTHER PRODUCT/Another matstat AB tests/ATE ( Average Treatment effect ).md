$y_i$ - результат измерения
$x_i$ - прочие переменные 

Когда мы разбиваем наших пользователей на выборки, у нас пользователь попадает либо в контрольную, либо в тестовую группу. Однако нас также интересует тот результат, которые принесли наши внедрения по каждому пользователю. Но мы не можем опять же такой результат получить, так как  у нас пользователь либо в тестовой выборке, либо в контрольной.  Поэтому и есть ATE. 

ATE = $E(y_i(1) - y_i(0))$  

И эту штуку мы пытаемся в А/Б тесте оценить. 

`CATE (Conditional Average Treatment Effect)` в контексте A/B тестов — это метрика, которая измеряет средний эффект воздействия (например, новой функции или изменения) на определённую подгруппу пользователей. В отличие от ATE (Average Treatment Effect), который оценивает средний эффект на всю популяцию, CATE фокусируется на среднем эффекте в зависимости от определённых характеристик или условий.

Но по сути, мы можем посчитать разность между $E(y_i(1)) - E(y_i(0))$ .  То есть просто разность между мат.ожиданием тестовой и контрольной выборки. 

Если мы будем раскрывать это дальше : 

$$
E(y_i | d_i= 1) - E(y_i | d_i = 0) = E(y_i(1) | d_i= 1) - E(y_i(0) | d_i = 0)  =  E(y_i(1) | d_i= 1) - E(y_i(0) | d_i = 1)  +  E(y_i(0) | d_i= 1) - E(y_i(0) | d_i = 0) =  E(y_i(1)  - y_i(0))| d_i= 1) - E(y_i(0) | d_i = 0) - E(y_i(0) | d_i = 1)
$$

И вот последнее, что у нас получилось , а именно 

$$
E(y_i(1)  - y_i(0)| d_i= 1) - E(y_i(0) | d_i = 0) - E(y_i(0) | d_i = 1)
$$

Первая штука  $E(y_i(1)  - y_i(0)| d_i= 1)$  это ATET . Средний эффект воздействия на тех, кто ему подвергся. 

А вот второе слогаемое ( $E(y_i(0) | d_i = 0) - E(y_i(0) | d_i = 1)$ ) это Selection Bias (SB) или смещение из-за самоотбора. 