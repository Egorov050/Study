Прежде чем работать с конверсией, очевидно нужно прочистить датасет...подготовить его в работе...
Когда мы его подготовили, можем приступить :)

<h6>Строим конверсию</h6>
Предположим, что у нас есть датасет с покупками ( например такой https://www.kaggle.com/datasets/yasserh/customer-segmentation-dataset/data )

Для начала мы должны найти `первый стартовый день` когда пользователь `в нашем случае`совершил покупку. Грубо говоря пишем это так : 

```python
first_sale = df.groupby('CustomerID').agg({'date' : 'min'}).reset_index()
first_sale = first_sale.rename(columns=({'date' : 'first'}))
first_sale
```

| CustomerID | first   |            |
| ---------- | ------- | ---------- |
| 0          | 12346.0 | 2011-01-18 |
| 1          | 12347.0 | 2010-12-07 |
| 2          | 12348.0 | 2010-12-16 |
| 3          | 12349.0 | 2011-11-21 |
| 4          | 12350.0 | 2011-02-02 |
| ...        | ...     | ...        |
| 4367       | 18280.0 | 2011-03-07 |
| 4368       | 18281.0 | 2011-06-12 |
| 4369       | 18282.0 | 2011-08-05 |
| 4370       | 18283.0 | 2011-01-06 |
| 4371       | 18287.0 | 2011-05-22 |
